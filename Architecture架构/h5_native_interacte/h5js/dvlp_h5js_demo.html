<!--
 * @Author: dvlproad
 * @Date: 2022-12-27 11:59:38
 * @LastEditors: dvlproad
 * @LastEditTime: 2023-02-10 16:06:46
 * @Description: è°ƒè¯•h5ä¸appäº¤äº’çš„ç½‘é¡µdemo
-->
<!--
ä¸€ã€ä½¿ç”¨fileUrlå‚æ•°
1ã€æœ¬åœ°æœåŠ¡å™¨æµ‹è¯•
url1:  http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?å‚æ•°å¦‚ä¸‹egä¸­çš„å€¼
eg1.1: fileUrl=dvlp_h5js_demo.json
eg1.2: fileUrl=http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.json

2ã€è¿œç¨‹æœåŠ¡å™¨æµ‹è¯•
url2:  https://dvlproad.github.io/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?å‚æ•°å¦‚ä¸‹egä¸­çš„å€¼
eg2.1: fileUrl=dvlp_h5js_demo.json
eg2.2: fileUrl=https://dvlproad.github.io/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.json
eg2.3(æµ‹è¯•è·¨åŸŸ): fileUrl=https://raw.githubusercontent.com/dvlproad/dvlproad.github.io/master/Architecture%E6%9E%B6%E6%9E%84/h5js/dvlp_h5js_demo/dvlp_h5js_demo.json
eg2.4(æµ‹è¯•è·¨åŸŸ): 
eg2.5(æµ‹è¯•è·¨åŸŸ): 

äºŒã€ä½¿ç”¨å„ç§dataJsonå‚æ•°
1ã€æœ¬åœ°æœåŠ¡å™¨æµ‹è¯•
url1:  http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?å‚æ•°å¦‚ä¸‹egä¸­çš„å€¼
eg1.1(æœªç¼–ç h5CallBridgeSendMessageï¼Œåœ¨æµè§ˆå™¨ä¸­éªŒè¯å¯ä»¥ã€‚ä½†åœ¨appä¸­ä¸è¡Œï¼Œå¿…é¡»å¯¹æ¯ä¸ªå‚æ•°ç¼–ç åå†èµ‹å€¼ï¼Œä»¥é¿å…å‚æ•°ä¸­å«ä¸­æ–‡æˆ–è€…å¯¹è±¡): 
h5CallBridgeActionDes=è·³è½¬åˆ°appæŒ‡å®šé¡µé¢_Name&h5CallBridgeActionName=h5CallBridgeAction_jumpAppPage&h5CallBridgeSendMessage={"pageName":"imChatPage","pageParams":{"conversationID":"126191","imUserId":"1602856363702501376","showName":"å©‰è‰º","type":1,"dialogSubjectId":"1506196208391966720"}}
eg1.2(æœ‰ç¼–ç h5CallBridgeSendMessageï¼ŒéªŒè¯å¯ä»¥): 
h5CallBridgeActionDes=è·³è½¬åˆ°appæŒ‡å®šé¡µé¢_Name&h5CallBridgeActionName=h5CallBridgeAction_jumpAppPage&h5CallBridgeSendMessage=%7B%22pageName%22%3A%22imChatPage%22%2C%22pageParams%22%3A%7B%22conversationID%22%3A%22126191%22%2C%22imUserId%22%3A%221602856363702501376%22%2C%22showName%22%3A%22%E5%A9%89%E8%89%BA%22%2C%22type%22%3A1%2C%22dialogSubjectId%22%3A%221506196208391966720%22%7D%7D

-->
<!DOCTYPE html>
<html lang="en">

<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>html demo</title>
</head>
<style>
  .hide {
    display: none !important;
  }

  .dialog {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .dialog .content {
    background: white;
    padding: 30px 20px;
  }

  .dialog .content .msg {
    font-size: 16px;
  }

  .dialog .content .close-btn {
    margin-top: 10px;
    width: 100px;
    height: 36px;
    background-color: #fff;
    border: 1px solid blue;
    font-size: 14px;
    color: blue;
  }
</style>

<body>
  <div class="dialog hide">
    <div class="content">
      <div class="msg" id="msg">æ¶ˆæ¯å†…å®¹</div>
      <button class="close-btn" onclick="handleCloseDialog()">æˆ‘çŸ¥é“äº†</button>
    </div>
  </div>
  <div id="pageTilteView" style="text-align: center; font-size: 20px;">
    appå†…çš„ç½‘é¡µh5è°ƒç”¨appçš„æ¼”ç¤ºdemo
    <button onclick="_h5Action_goDemoPage()" style="font-size: 12px;">æŸ¥çœ‹ç¤ºä¾‹</button>
  </div>
  <div id="pageSubTilteView" style="text-align: center; font-size: 14px;">æ•°æ®æ¥æºäºï¼šxxx</div>
  <div>
    <div id="h5CallBridgeActionDesTitleView">â‘ h5è°ƒç”¨çš„appæ¡¥æ¥æ–¹æ³•åï¼š</div>
    <div id="h5CallBridgeActionDesDataView"></div>
  </div>
  <textarea id="h5CallBridgeActionNameDataView" style="height: 16px; width: 95%;">æ–¹æ³•å</textarea>

  <div id="h5CallBridgeSendMessageTitleView">â‘¡h5è°ƒç”¨appæ¡¥æ¥æ–¹æ³•åï¼Œå‘é€çš„å‚æ•°ï¼š</div>
  <textarea id="h5CallBridgeSendMessageDataView" style="height: 200px; width: 95%;">å¤šè¡Œçš„æ–‡æœ¬è¾“å…¥æ¡†</textarea>

  <div id="h5CallBridgeDescriptionTitleView">â‘¢h5è°ƒç”¨appæ¡¥æ¥æ–¹æ³•åï¼Œå‘é€çš„å‚æ•°è¯´æ˜ï¼š</div>
  <textarea id="h5CallBridgeDescriptionDataView" style="height: 80px; width: 95%;">å¤šè¡Œçš„æ–‡æœ¬è¾“å…¥æ¡†</textarea>

  <button id="evalButtonView" onclick="_h5CallBridgeAction_eval()" style="background-color: red; color: white; height: 30px; width: 95%; font-size: 20px;">æ‰§è¡Œä¸Šè¿°çš„h5è°ƒç”¨appçš„æ–¹æ³•</button>



  <!-- <div>åˆ†äº«å†…å®¹åˆ°æŒ‡å®šçš„åˆ†äº«æ–¹å¼(å¾®ä¿¡èŠå¤©é¡µé¢ç­‰)</div>
  <button
    onclick="h5Action_updateTextAreaValue_share('åªæ˜¯åˆ†äº«ç½‘é¡µé“¾æ¥ï¼Œæ²¡å…¶ä»–æ“ä½œ')">'ç¡¬ç¼–ç çš„æŒ‰é’®ï¼šåªæ˜¯åˆ†äº«ç½‘é¡µé“¾æ¥ï¼Œæ²¡å…¶ä»–æ“ä½œ'</button>
  <button
    onclick="h5Action_updateTextAreaValue_share('åˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_åŸç”Ÿé¡µé¢')">'ç¡¬ç¼–ç çš„æŒ‰é’®ï¼šåˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_åŸç”Ÿé¡µé¢'</button>
  <button
    onclick="h5Action_updateTextAreaValue_share('åˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_ç½‘é¡µæ¸¸æˆ')">'ç¡¬ç¼–ç çš„æŒ‰é’®ï¼šåˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_ç½‘é¡µæ¸¸æˆ'</button> -->

  <div id="h5Action_updateTextAreaValue_buttons_div"></div>

</body>


<!-- [ç§»åŠ¨ç«¯è°ƒè¯•ç¥å™¨vConsoleä½¿ç”¨è¯¦è§£](https://www.jb51.net/article/244750.htm) -->
<script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
<script>
  // VConsole é»˜è®¤ä¼šæŒ‚è½½åˆ° `window.VConsole` ä¸Š
  var vConsole = new window.VConsole();
  // æ¥ä¸‹æ¥å³å¯ç…§å¸¸ä½¿ç”¨ `console` ç­‰æ–¹æ³•
  console.log('Hello world');

  // ç»“æŸè°ƒè¯•åï¼Œå¯ç§»é™¤æ‰
  vConsole.destroy();
</script>


<!-- [å¼•å…¥jquery.js ä¿®å¤å‡ºç°çš„é”™è¯¯ï¼šReferenceError: $ is not defined](https://blog.csdn.net/lq_ruonan/article/details/53690960) -->
<script src="https://code.jquery.com/jquery-3.6.3.js" type="text/javascript" charset="utf-8"></script>
<!-- <script src="js/jQuery.js" type="text/javascript" charset="utf-8"></script> -->


<script>
  // åˆå§‹åŒ–
  // localStorage.setItem('vConsole_switch_x', 50)
  // var vConsole = new VConsole();
  // console.log('Hello world');
  var _demoSectionArray;
  var h5CallBridgeActionDesArray = [];

  // function readJson(url) {
  //   var request = new XMLHttpRequest();
  //   request.open("get", url);/*è®¾ç½®è¯·æ±‚æ–¹æ³•ä¸è·¯å¾„*/
  //   request.send(null);/*ä¸å‘é€æ•°æ®åˆ°æœåŠ¡å™¨*/
  //   request.onload = function () {/*XHRå¯¹è±¡è·å–åˆ°è¿”å›ä¿¡æ¯åæ‰§è¡Œ*/
  //     if (request.status == 200) {/*è¿”å›çŠ¶æ€ä¸º200ï¼Œå³ä¸ºæ•°æ®è·å–æˆåŠŸ*/
  //       var json = JSON.parse(request.responseText);
  //       for (var i = 0; i < json.length; i++) {
  //         console.log(json[i].name);
  //       }
  //       console.log(json);
  //       debugger
  //     }
  //   }
  // }

  function handleCloseDialog() {
    document.querySelector(".dialog").classList.add("hide");
    // copy(".msg")
  }
  function handleShowDialog() {
    document.querySelector(".dialog").classList.remove("hide");
  }

  // function copy(id) {
  //   var clipboard = new Clipboard(id);
  //   clipboard.on('success', function (e) {
  //     _showAlert("å¤åˆ¶æˆåŠŸ");
  //     //å¯æ‰§è¡Œå…¶ä»–ä»£ç æ“ä½œ
  //   });
  //   clipboard.on('error', function () {
  //     _showAlert("å¤åˆ¶å¤±è´¥")
  //   });
  // }

  function _showAlert(msg) {
    handleShowDialog();
    let t = document.querySelector(".msg");
    t.innerHTML = msg;
  }

  function readJson(url) {
    return new Promise((resolve, reject) => {
      $.ajax({
        url: url,//åŒæ–‡ä»¶å¤¹ä¸‹çš„jsonæ–‡ä»¶è·¯å¾„
        type: "GET",//è¯·æ±‚æ–¹å¼ä¸ºget
        dataType: "json", //è¿”å›æ•°æ®æ ¼å¼ä¸ºjson
        success: function (data) {//è¯·æ±‚æˆåŠŸå®Œæˆåè¦æ‰§è¡Œçš„æ–¹æ³• 
          console.log(`è¯»å–${url}æˆåŠŸ,æ•°æ®dataçš„å€¼ä¸º\n${data}`);
          console.log(`è¯»å–${url}æˆåŠŸ,æ•°æ®dataè½¬å­—ç¬¦ä¸²åçš„å€¼ä¸º\n${JSON.stringify(data)}`);

          // var array = data;
          // for (let index = 0; index < array.length; index++) { //å¾ªç¯åå°ä¼ è¿‡æ¥çš„Jsonæ•°ç»„ 
          //   const element = array[index];
          //   console.log(`data${index}:` + element);
          //   console.log(`data${index}:` + element.h5CallBridgeActionDes);
          // }
          resolve(data);
        },
        error: function (err) {
          // debugger // æ–­ç‚¹è°ƒè¯•
          resolve(null);
        }

      })
    })
    // $.get('./test_h5js_demo.json', function (data) {

    //   //è¯»è¿›äº†dataå˜é‡ä¸­
    //   //æ¥ä¸‹æ¥ç”¨åˆ°dataçš„ä»£ç å¿…é¡»å…¨éƒ¨åœ¨æ­¤å‡½æ•°å†…éƒ¨è¿›è¡Œ
    //   console.log("data:" + data);
    // });



    // d3.json('./test_h5js_demo.json', function (error, authordata) {
    //   if (error) console.error(error);
    //   //è¯»è¿›äº†authordataå˜é‡
    //   //æ¥ä¸‹æ¥ç”¨åˆ°authordataçš„ä»£ç å¿…é¡»å…¨éƒ¨åœ¨æ­¤å‡½æ•°å†…éƒ¨è¿›è¡Œ
    //   console.log("data:" + data);
    // });
    // if (window.FileReader) {
    //   let reader = new FileReader();
    //   let file = new File(
    //     [blob],
    //     url,
    //     {
    //       type: 'text/plain',
    //     }
    //   );
    //   reader.readAsText(file);
    //   reader.onload = function () {
    //     console.log('è¯»å–æˆåŠŸ');
    //     var data = reader.result;   //base64å½¢å¼çš„æ–‡ä»¶å†…å®¹
    //   };
    //   reader.onerror = function () {
    //     console.log('è¯»å–å¤±è´¥');
    //     console.log(reader.error);
    //   }
    // } else {
    //   console.log('ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒè¯»å–æ–‡ä»¶');
    // }
  }

  function getLocalDemoMapArray() {
    let localDemoMapArray = [
      {
        "sectionTitle": "åªæ˜¯æµ‹è¯•æ–¹æ³•ï¼Œä¸å†å®é™…é¡¹ç›®ä¸­ä½¿ç”¨",
        // "sectionBG": "#FF0000",
        "sectionDatas": [
          {
            "h5CallBridgeActionDes": "æµ‹è¯• h5 è°ƒç”¨ app æ–¹æ³•ï¼Œå¹¶å°†è¿”å›å€¼å›è°ƒç»™ h5",
            "h5CallBridgeActionName": "h5CallBridgeAction_test_h5CallAppAndCallBackToH5",
            "h5CallBridgeSendMessage": {
              "callbackMethod": "bridgeCallH5Action_showCallbackJsonString",
              "url": "https://www.baidu.com"
            }
          }
        ]
      }
    ];

    // return null; // æµ‹è¯•æœ¬åœ°æœªèµ‹å€¼æ—¶å€™çš„ç•Œé¢å±•ç¤º
    return localDemoMapArray;
  }

  /// å¤„ç†åè®®è·³è½¬
  /// è§„åˆ™è¯´æ˜ï¼š
  /// yuanwangwu://openpage?pageName=XXXX&orderId=XXXXX
  /// å¦‚æœæ˜¯ä»å¤–éƒ¨h5è·³è½¬appä½¿ç”¨ yuanwangwu://openpage?pageName=webPage&url=URLEncode(http://www.baidyu.com)
  /// ä¾‹ï¼šyuanwangwu://openpage?pageName=webPage&url=http%3A%2F%2Fwww.baidu.com
  /// å¦‚æœæ˜¯è·³è½¬åˆ°å†…éƒ¨é¡µé¢ ä½¿ç”¨ï¼šyuanwangwu://openpage?pageName=XXXXXX&id=XXX
  /// ä¾‹ï¼šyuanwangwu://openpage?pageName=testPage&id=123
  /// å¦‚æœæ˜¯è·³è½¬ã€å¾®ä¿¡å°ç¨‹åºã€‘ ä½¿ç”¨ï¼šyuanwangwu://openpage?pageName=mp&path=URLEncode(XXX)
  /// ä¾‹ï¼šç•¥
  // var message = 'yuanwangwu://openpage?pageName=webPage&url=URLEncode(http://www.baidu.com)';
  async function initData() { // æ³¨æ„å¿…é¡»åŠ  async ,å¦åˆ™å‡½æ•°å†…ä½¿ç”¨ await ä¼šæŠ¥é”™
    console.log("æŸ¥çœ‹æ˜¯å¦æœ‰ä½¿ç”¨fileUrlæˆ–è€…h5CallBridgeActionNameå‚æ•°,è‹¥éƒ½æ— ï¼Œåˆ™å°†ä½¿ç”¨æœ¬htmlçš„é»˜è®¤æ•°æ®");
    let url_param_fileUrl = getQueryString("fileUrl"); // ä»æµè§ˆå™¨çš„ç½‘é¡µåœ°å€ä¸­è¯»å– fileUrl å‚æ•°
    console.log(`========url_param_fileUrl:${url_param_fileUrl}`);

    let url_param_h5CallBridgeActionName = getQueryString("h5CallBridgeActionName"); // ä»æµè§ˆå™¨çš„ç½‘é¡µåœ°å€ä¸­è¯»å– h5CallBridgeActionName å‚æ•°
    console.log(`========url_param_h5CallBridgeActionName:${url_param_h5CallBridgeActionName}`);

    let url_param_h5CallBridgeActionDes = getQueryString("h5CallBridgeActionDes"); // ä»æµè§ˆå™¨çš„ç½‘é¡µåœ°å€ä¸­è¯»å– h5CallBridgeActionDes å‚æ•°
    console.log(`========url_param_h5CallBridgeActionDes:${url_param_h5CallBridgeActionDes}ã€é™„ï¼šä¸èƒ½ä½¿ç”¨h5CallBridgeActionNameçš„å€¼ï¼Œä¼šå‡ºç°å½“æŠŠæ­¤htmlæ”¾åˆ°appé¡¹ç›®ä¸­åŠ è½½æœ¬åœ°htmlçš„æ—¶å€™ï¼Œè«åå‡ºç°h5CallBridgeActionNameæœ‰å€¼çš„æƒ…å†µï¼ŒPSå½“å‰è¯¥å€¼ä¸º${url_param_h5CallBridgeActionName}ã€‘`);

    if (url_param_fileUrl == null && url_param_h5CallBridgeActionDes == null) {
      _h5Action_updateText_forTitle("æ•°æ®æ¥æºäº:æœ¬htmlå†…åµŒ");
      var promptMessage = "æœªè®¾ç½®æœ¬htmlçš„jsonæ–‡ä»¶è·¯å¾„,ä¹Ÿæœªè®¾ç½®h5CallBridgeå‚æ•°ï¼Œåˆ™å°†ä½¿ç”¨æœ¬åœ°é»˜è®¤çš„ demoMapArray å€¼";

      _demoSectionArray = getLocalDemoMapArray();
      if (_demoSectionArray == null) { // æœ¬htmlæœªå°†jsonæ–‡ä»¶çš„å€¼èµ‹å€¼ç»™ demoMapArray
        localArrayResultMessage = `${promptMessage}:è·å–æœ¬åœ°é»˜è®¤çš„ demoMapArray å¤±è´¥âŒ\nè¯·æ‰“å¼€æœ¬htmlæ–‡ä»¶ï¼Œæ£€æŸ¥demoMapArrayçš„æœ¬åœ°èµ‹å€¼æ˜¯å¦æ­£ç¡®`;
        console.log(`${localArrayResultMessage}`);

        _showErrorUI(localArrayResultMessage);
        return;

      } else {
        localArrayResultMessage = `${promptMessage}:è·å–æœ¬åœ°é»˜è®¤çš„ demoMapArray æˆåŠŸâœ…`;
        console.log(`${localArrayResultMessage}`);
      }


    } else {
      if (url_param_fileUrl == null) {
        _h5Action_updateText_forTitle(`æ•°æ®æ¥æºäº:æœ¬htmlæµè§ˆå™¨ç½‘é¡µåœ°å€ä¸­çš„ h5CallBridgeActionName=${url_param_h5CallBridgeActionName} ç­‰å‚æ•°`);
        var dataJsonSuccess = _checkDataJson();
        if (dataJsonSuccess != true) {
          return;
        }
      } else {
        _h5Action_updateText_forTitle("æ•°æ®æ¥æºäº:æœ¬htmlæµè§ˆå™¨ç½‘é¡µåœ°å€ä¸­çš„ fileUrl å‚æ•°");
        var fileUrlSuccess = await _checkFileUrlUI(url_param_fileUrl);
        if (fileUrlSuccess != true) {
          return;
        }
      }


    }

    // 
    _showSuccessUI(_demoSectionArray);
  }




  initData();

  function _checkDataJson() {
    var promptMessage = "å·²è®¾ç½®æœ¬htmlçš„dataJsonå‚æ•°ï¼Œåˆ™å°†è·å–ä½¿ç”¨å“ªäº›å‚æ•°æ„é€ å‡ºåªæœ‰ä¸€ä¸ªå…ƒç´ çš„ demoMapArray å€¼";
    var remoteArrayResultMessage = `${promptMessage}:è·å–æµè§ˆå™¨åœ°å€æŒ‡å®šçš„dataJsonå„å‚æ•°çš„å€¼æ¥ä½œä¸º demoMapArray æˆåŠŸâœ…`;
    console.log(`${remoteArrayResultMessage}`);

    // http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?h5CallBridgeActionDes=è·³è½¬åˆ°appæŒ‡å®šé¡µé¢_Name&h5CallBridgeActionName=h5CallBridgeAction_jumpAppPage&h5CallBridgeSendMessage={"pageName":"imChatPage","pageParams":{"conversationID":"126191","imUserId":"1602856363702501376","showName":"å©‰è‰º","type":1,"dialogSubjectId":"1506196208391966720"}}
    // http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?h5CallBridgeActionDes=è·³è½¬åˆ°appæŒ‡å®šé¡µé¢_Name&h5CallBridgeActionName=h5CallBridgeAction_jumpAppPage&h5CallBridgeSendMessage=%7B%22pageName%22%3A%22imChatPage%22%2C%22pageParams%22%3A%7B%22conversationID%22%3A%22126191%22%2C%22imUserId%22%3A%221602856363702501376%22%2C%22showName%22%3A%22%E5%A9%89%E8%89%BA%22%2C%22type%22%3A1%2C%22dialogSubjectId%22%3A%221506196208391966720%22%7D%7D
    // {
    //     "h5CallBridgeActionDes": "è·³è½¬åˆ°appæŒ‡å®šé¡µé¢_Name",
    //     "h5CallBridgeActionName": "h5CallBridgeAction_jumpAppPage",
    //     "h5CallBridgeSendMessage": {
    //       "pageName": "imChatPage",
    //       "pageParams": {
    //         "conversationID": "126191",
    //         "imUserId": "1602856363702501376",
    //         "showName": "å©‰è‰º",
    //         "type": 1,
    //         "dialogSubjectId": "1506196208391966720"
    //       }
    //     }
    //   }
    // ä»æµè§ˆå™¨çš„ç½‘é¡µåœ°å€ä¸­è¯»å– h5CallBridgeSendMessage ç­‰å‚æ•°
    console.log("dataJsonå„å‚æ•°è·å–åï¼Œä½†è·å–è¿‡ç¨‹ä¸­å†…éƒ¨å·²è§£ç ï¼Œå€¼åˆ†åˆ«å¦‚ä¸‹:")
    let param_string_h5CallBridgeActionDes = getQueryString("h5CallBridgeActionDes");
    let param_string_h5CallBridgeActionName = getQueryString("h5CallBridgeActionName");
    let param_string_h5CallBridgeSendMessage = getQueryString("h5CallBridgeSendMessage");
    console.log(`========param_string_h5CallBridgeActionDes:${param_string_h5CallBridgeActionDes}`);
    console.log(`========param_string_h5CallBridgeActionName:${param_string_h5CallBridgeActionName}`);
    console.log(`========param_string_h5CallBridgeSendMessage:${param_string_h5CallBridgeSendMessage}`);

    // console.log("dataJsonå„å‚æ•°è§£ç åï¼Œå€¼åˆ†åˆ«å¦‚ä¸‹:")
    // let param_decode_h5CallBridgeActionDes = decodeURIComponent(param_string_h5CallBridgeActionDes);
    // let param_decode_h5CallBridgeActionName = decodeURIComponent(param_string_h5CallBridgeActionName);
    // let param_decode_h5CallBridgeSendMessage = decodeURIComponent(param_string_h5CallBridgeSendMessage);
    // console.log(`========param_decode_h5CallBridgeActionDes:${param_decode_h5CallBridgeActionDes}`);
    // console.log(`========param_decode_h5CallBridgeActionName:${param_decode_h5CallBridgeActionName}`);
    // console.log(`========param_decode_h5CallBridgeSendMessage:${param_decode_h5CallBridgeSendMessage}`);

    // console.log("dataJsonå„å‚æ•°è§£ç åå¹¶è½¬objectæ¨¡å‹ï¼Œå€¼åˆ†åˆ«å¦‚ä¸‹:")
    // let param_object_h5CallBridgeSendMessage = JSON.parse(param_decode_h5CallBridgeSendMessage);
    // console.log(`========param_object_h5CallBridgeSendMessage:${param_object_h5CallBridgeSendMessage}`);

    let demoMap1 = {
      "h5CallBridgeActionDes": param_string_h5CallBridgeActionDes,
      "h5CallBridgeActionName": param_string_h5CallBridgeActionName,
      "h5CallBridgeSendMessage": param_string_h5CallBridgeSendMessage
    };

    _demoSectionArray = [
      {
        "sectionTitle": "é€šè¿‡ç»™æ­¤htmlä¼ å…¥dataJsonå„å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œåªæœ‰ä¸€ä¸ªå…ƒç´ ",
        "sectionDatas": [
          demoMap1
        ],
      }
    ];

    return true;
  }

  async function _checkFileUrlUI(fileUrl) { // æ³¨æ„å¿…é¡»åŠ  async ,å¦åˆ™å‡½æ•°å†…ä½¿ç”¨ await ä¼šæŠ¥é”™
    // http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.html?fileUrl=http://localhost:4000/Architectureæ¶æ„/h5js/dvlp_h5js_demo/dvlp_h5js_demo.json
    var promptMessage = "å·²è®¾ç½®æœ¬htmlçš„jsonæ–‡ä»¶è·¯å¾„ï¼Œåˆ™å°†è·å–è¯¥è·¯å¾„ä¸‹çš„jsonå€¼ä½œä¸º _demoSectionArray å€¼";
    _demoSectionArray = await readJson(fileUrl);
    if (_demoSectionArray == null) { // æœ¬htmlæœªå°†jsonæ–‡ä»¶çš„å€¼èµ‹å€¼ç»™ demoMapArray
      remoteArrayResultMessage = `${promptMessage}:è·å–æµè§ˆå™¨åœ°å€æŒ‡å®šçš„jsonæ–‡ä»¶${fileUrl}çš„å€¼æ¥ä½œä¸º demoMapArray å¤±è´¥âŒï¼Œè¯·æ ¹æ®ä»¥ä¸‹å¯èƒ½åŸå› æ£€æŸ¥`;
      let fileUrlFailureReason1 = `å¤±è´¥å¯èƒ½åŸå› 1:è·¯å¾„${fileUrl}å†™é”™`;
      let fileUrlFailureReasonLocal = "å¤±è´¥å¯èƒ½åŸå› 2:å¦‚æœæœ¬htmlæ˜¯æœ¬åœ°ç›´æ¥æ‰“å¼€çš„ï¼Œåˆ™jsonæ–‡ä»¶çš„éœ€æ‰‹åŠ¨æ‹·è´åˆ°æœ¬htmlä¸­(å› ä¸ºæš‚ä¸æ”¯æŒè¯»å–æœ¬åœ°çš„jsonæ–‡ä»¶)";
      let fileUrlFailureReasonRemote = "å¤±è´¥å¯èƒ½åŸå› 3:å¦‚æœæœ¬htmlæ˜¯ä»ç½‘ç»œåœ°å€ä¸Šæ‰“å¼€çš„ï¼Œåˆ™fileUrlå¿…é¡»å’Œæœ¬htmlçš„æ‰€åœ¨å·¥ç¨‹ä¸€è‡´(å› ä¸ºæš‚ä¸æ”¯æŒè·¨åŸŸè®¿é—®)";
      remoteArrayResultMessage = `${remoteArrayResultMessage}\n${fileUrlFailureReason1}\n${fileUrlFailureReasonLocal}\n${fileUrlFailureReasonRemote}`
      console.log(`${remoteArrayResultMessage}`);

      _showErrorUI(remoteArrayResultMessage);
      return false;

    } else {
      remoteArrayResultMessage = `${promptMessage}:è·å–æµè§ˆå™¨åœ°å€æŒ‡å®šçš„jsonæ–‡ä»¶${fileUrl}çš„å€¼æ¥ä½œä¸º demoMapArray æˆåŠŸâœ…`;
      console.log(`${remoteArrayResultMessage}`);
      return true;
    }
  }

  function _showErrorUI(errorMessage) {
    let htmlStr = "";
    var h5Action_warningButton_onClick = `_h5CallBridgeAction_alert("${errorMessage}");`;
    var iButtonHtmlString = `<button onClick='${h5Action_warningButton_onClick}' style="width: 95%; height: 30px;">"${errorMessage}</button>`

    htmlStr += `${iButtonHtmlString}`;
    document.querySelector("#h5Action_updateTextAreaValue_buttons_div").innerHTML = htmlStr;
  }

  // æ‰§è¡Œ h5 å¼¹å‡ºé”™è¯¯æç¤ºçš„ alert
  function _h5CallBridgeAction_alert(errorMessage) {
    console.log(errorMessage);
    alert(errorMessage);
  }

  function _showSuccessUI(demoSectionArray) {
    console.log(`æœ€ç»ˆè¦æ˜¾ç¤ºçš„æ•°æ®å¦‚ä¸‹:\n demoSectionArray:${demoSectionArray}\n demoSectionArrayString:${JSON.stringify(demoSectionArray)}`);

    var sectionCount = demoSectionArray.length;
    // å½“æ•´ä¸ªsectionå°±åªæœ‰ä¸€ä¸ªå¯é€‰æ“ä½œå…ƒç´ çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨
    if (sectionCount == 1) {
      const sectionDatas = demoSectionArray[0]["sectionDatas"];
      if (sectionDatas.length == 1) {
        const element = sectionDatas[0];
        _useDirectlyWhenOnlyOneElement(element);
        return;
      }
    }

    /// å½“æ•´ä¸ªsectionä¸æ­¢ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œç½—åˆ—åœ¨ç•Œé¢ä¸Šï¼Œä¾›é€‰æ‹©ä½¿ç”¨
    let htmlStr = "";
    for (let sectionIndex = 0; sectionIndex < sectionCount; sectionIndex++) {
      const sectionElement = demoSectionArray[sectionIndex];

      let sectionHtmlString = _getSectionHtmlString(sectionIndex, sectionElement["sectionDatas"]);

      // let sectionHtmlString = `<div id="pageTilteView" style="text-align: center; font-size: 20px;">æ¼”ç¤ºçš„section</div>`
      var iSectionDivHtmlString = `
      <div id='section_id_${sectionIndex}' style="width: 95%;">
        <div style="width: 95%; background-color: ${sectionElement["sectionBG"]};">${sectionElement["sectionTitle"]}</div>
        ${sectionHtmlString}
      </div>
      `
      if (sectionIndex < sectionCount - 1) {
        iSectionDivHtmlString += `<div style="height: 20px;"></div>`;
      }
      // console.log(`iSectionDivHtmlString${sectionIndex}=${iSectionDivHtmlString}`);
      htmlStr += `${iSectionDivHtmlString}`;
    }

    document.querySelector("#h5Action_updateTextAreaValue_buttons_div").innerHTML = htmlStr;
  }

  /// å½“æ•´ä¸ªsectionå°±åªæœ‰ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨
  function _useDirectlyWhenOnlyOneElement(element) {
    var h5CallBridgeActionDes = element["h5CallBridgeActionDes"];
    h5CallBridgeActionDesArray.push(h5CallBridgeActionDes);

    // [JSå­—ç¬¦ä¸²æ‹¼æ¥çš„å‡ ç§æ–¹å¼](https://blog.csdn.net/u012320487/article/details/123822785)
    sectionIndex = 0;
    rowIndex = 0;
    var h5Action_updateTextAreaValue_onClick = `_h5Action_updateText_byIndex(${sectionIndex}, ${rowIndex});`;

    // [js(JavaScript)å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡å](https://huaweicloud.csdn.net/63a55da9b878a54545945264.html?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~activity-1-102934655-blog-92951596.pc_relevant_recovery_v2&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~activity-1-102934655-blog-92951596.pc_relevant_recovery_v2&utm_relevant_index=1)
    // åˆ©ç”¨ eval() å‡½æ•°è®¡ç®— JavaScript å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒä½œä¸ºè„šæœ¬ä»£ç æ¥æ‰§è¡Œã€‚å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œeval() å‡½æ•°å°†æ‰§è¡Œè¡¨è¾¾å¼ã€‚å¦‚æœå‚æ•°æ˜¯Javascriptè¯­å¥ï¼Œeval()å°†æ‰§è¡Œ Javascript è¯­å¥ã€‚
    var funName = h5Action_updateTextAreaValue_onClick;

    try {
      eval(funName);
    } catch (err) {
      // console.log(`---------------err:${err}`);
      _showAlert(err);
    }

  }

  function _getSectionHtmlString(sectionIndex, demoMapArray) {
    console.log(`${sectionIndex}å½“å‰åŒºè¦æ˜¾ç¤ºçš„æ•°æ®å¦‚ä¸‹:\n demoMapArray:${demoMapArray}\n demoMapArrayString:${JSON.stringify(demoMapArray)}`);

    let sectionHtmlString = "";
    var demoMapCount = demoMapArray.length;
    for (let rowIndex = 0; rowIndex < demoMapCount; rowIndex++) {
      const element = demoMapArray[rowIndex];
      var h5CallBridgeActionDes = element["h5CallBridgeActionDes"];
      h5CallBridgeActionDesArray.push(h5CallBridgeActionDes);

      // [JSå­—ç¬¦ä¸²æ‹¼æ¥çš„å‡ ç§æ–¹å¼](https://blog.csdn.net/u012320487/article/details/123822785)
      var h5Action_updateTextAreaValue_onClick = `_h5Action_updateText_byIndex(${sectionIndex}, ${rowIndex});`;
      var iButtonHtmlString = `<button onClick='${h5Action_updateTextAreaValue_onClick}' style="width: 95%; height: 30px;">${sectionIndex + 1}.${rowIndex + 1}.${h5CallBridgeActionDes}</button>`
      if (rowIndex > 0) {
        // htmlStr += `<>`;
      }
      console.log(`iButtonHtmlString${rowIndex}=${iButtonHtmlString} element=${JSON.stringify(element)}`);
      sectionHtmlString += `${iButtonHtmlString}`;
    }
    return sectionHtmlString;
  }

  // [jsè·å–urlä¸­çš„ä¸­æ–‡å‚æ•°å‡ºç°ä¹±ç è§£å†³](https://www.codeleading.com/article/87533774933/)
  // "http://localhost:4000/Architecture%E6%9E%B6%E6%9E%84/h5js/dvlp_h5js_demo/dvlp_h5js_demo.json"; // urlå«ä¸­æ–‡ç¤ºä¾‹
  // "http://localhost/test/test.html?p=å¹¿ä¸œ&c=ç æµ·"
  function getQueryString(key) {
    // è·å–å‚æ•°
    var url = window.location.search;
    // æ­£åˆ™ç­›é€‰åœ°å€æ 
    var reg = new RegExp("(^|&)" + key + "=([^&]*)(&|$)");
    // åŒ¹é…ç›®æ ‡å‚æ•°
    var result = url.substr(1).match(reg);
    //è¿”å›å‚æ•°å€¼
    // return result ? unescape(result[2]) : null; // urlä¸­å«ä¸­æ–‡æ—¶å€™ï¼Œå–å€¼ä¼šå‡ºé”™
    return result ? decodeURIComponent(result[2]) : null;
  }


  /// æ ¹æ®æ ‡é¢˜ï¼Œè·å–å…¶æ•´ä¸ªæ•°æ®æ¨¡å‹
  function _getElementByIndex(sectionIndex, rowIndex) {
    // var index = h5CallBridgeActionDesArray.indexOf(h5CallBridgeActionDes);
    // var demoMap = _demoSectionArray[index];
    var demoMap = _demoSectionArray[sectionIndex]["sectionDatas"][rowIndex];

    return demoMap;
  }

  /// æ›´æ–° h5è°ƒç”¨çš„appæ¡¥æ¥æ–¹æ³•å å’Œ  h5è°ƒç”¨appæ¡¥æ¥æ–¹æ³•åï¼Œå‘é€çš„æ•°æ®
  function _h5Action_updateText_byIndex(sectionIndex, rowIndex) {
    var demoMap = _getElementByIndex(sectionIndex, rowIndex);
    console.log(`-------å½“å‰æ‰€é€‰æ‹©çš„å€¼${sectionIndex}.${rowIndex}-------demoMap=${demoMap},demoMapString=${JSON.stringify(demoMap)}`);


    var h5CallBridgeActionDes = demoMap["h5CallBridgeActionDes"];

    var h5CallBridgeActionName = demoMap["h5CallBridgeActionName"];

    var h5CallBridgeSendMessage = demoMap["h5CallBridgeSendMessage"];
    if (typeof h5CallBridgeSendMessage == 'string') {
      // 
    } else {
      h5CallBridgeSendMessage = JSON.stringify(h5CallBridgeSendMessage);
    }

    var h5CallBridgeDescription = demoMap["h5CallBridgeDescription"];
    if (typeof h5CallBridgeDescription == 'string') {
      // 
    } else {
      h5CallBridgeDescription = JSON.stringify(h5CallBridgeDescription);
    }

    _h5Action_updateText_forData(h5CallBridgeActionDes, h5CallBridgeActionName, h5CallBridgeSendMessage, h5CallBridgeDescription);
  }

  /// æ›´æ–° æ ‡é¢˜
  function _h5Action_updateText_forTitle(dataFromSource) {
    console.log(`æ›´æ–°UIä¸Šçš„å‰¯æ ‡é¢˜ä¸º:${dataFromSource}`);
    document.getElementById("pageSubTilteView").innerHTML = `ï¼ˆ${dataFromSource}ï¼‰`;
  }

  /// æ›´æ–° h5è°ƒç”¨çš„appæ¡¥æ¥æ–¹æ³•å å’Œ  h5è°ƒç”¨appæ¡¥æ¥æ–¹æ³•åï¼Œå‘é€çš„æ•°æ®
  function _h5Action_updateText_forData(h5CallBridgeActionDes, h5CallBridgeActionName, h5CallBridgeSendMessage, h5CallBridgeDescription) {
    console.log(`æ›´æ–°UIä¸Šçš„å„éƒ¨åˆ†æ•°æ®åˆ†åˆ«ä¸º:\n----${h5CallBridgeActionName}\n----${h5CallBridgeSendMessage}\n----${h5CallBridgeDescription}`);
    document.getElementById("h5CallBridgeActionDesDataView").innerHTML = '' + h5CallBridgeActionDes;
    document.getElementById("h5CallBridgeActionNameDataView").innerHTML = '' + h5CallBridgeActionName;
    document.getElementById("h5CallBridgeSendMessageDataView").innerHTML = h5CallBridgeSendMessage;
    document.getElementById("h5CallBridgeDescriptionDataView").innerHTML = h5CallBridgeDescription;
  }

  /// è·å–h5è°ƒç”¨çš„appæ¡¥æ¥æ–¹æ³•å
  function _h5Action_getSendMethod() {
    var sendMethod = document.getElementById("h5CallBridgeActionNameDataView").value;
    return sendMethod;
  }

  /// è·å–h5è°ƒç”¨appæ¡¥æ¥æ–¹æ³•åï¼Œå‘é€çš„æ•°æ®
  function _h5Action_getSendMessage() {
    var sendMessage = document.getElementById("h5CallBridgeSendMessageDataView").value;
    return sendMessage;
  }

  // æ‰§è¡Œ h5è°ƒç”¨appçš„æ¡¥æ¥æ–¹æ³•
  function _h5CallBridgeAction_eval() {
    // var funName = 'h5CallBridgeAction_showAppToast';
    // var sendMessage = 'æ­å–œæ‚¨åˆ†äº«æˆåŠŸ';
    // h5CallBridgeAction_showAppToast.postMessage(sendMessage);

    // [js(JavaScript)å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡å](https://huaweicloud.csdn.net/63a55da9b878a54545945264.html?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~activity-1-102934655-blog-92951596.pc_relevant_recovery_v2&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~activity-1-102934655-blog-92951596.pc_relevant_recovery_v2&utm_relevant_index=1)
    // åˆ©ç”¨ eval() å‡½æ•°è®¡ç®— JavaScript å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒä½œä¸ºè„šæœ¬ä»£ç æ¥æ‰§è¡Œã€‚å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œeval() å‡½æ•°å°†æ‰§è¡Œè¡¨è¾¾å¼ã€‚å¦‚æœå‚æ•°æ˜¯Javascriptè¯­å¥ï¼Œeval()å°†æ‰§è¡Œ Javascript è¯­å¥ã€‚
    var funName = _h5Action_getSendMethod();
    var sendMessage = _h5Action_getSendMessage();

    try {
      eval(funName).postMessage(sendMessage);
    } catch (err) {
      // console.log(`---------------err:${err}`);
      _showAlert(err);
    }

    console.log(sendMessage.message);
  }


  // h5Action_share åˆ†äº«å†…å®¹åˆ°æŒ‡å®šçš„åˆ†äº«æ–¹å¼(å¾®ä¿¡èŠå¤©é¡µé¢ç­‰)
  /*
  function h5Action_updateTextAreaValue_share(webPageType) {
    var url;
    if (webPageType == 'åªæ˜¯åˆ†äº«ç½‘é¡µé“¾æ¥ï¼Œæ²¡å…¶ä»–æ“ä½œ') {
      url = "https://www.baidu.com";
    } else if (webPageType == 'åˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_åŸç”Ÿé¡µé¢') {
      url = 'yuanwangwu://openpage?pageName=imChatPage&conversationID=126191&imUserId=1602856363702501376&showName=å©‰è‰º&type=1&dialogSubjectId=1506196208391966720';
    } else if (webPageType == 'åˆ†äº«é“¾æ¥ï¼Œä¸”é“¾æ¥å¯æ‰“å¼€appçš„_ç½‘é¡µæ¸¸æˆ') {
      var appOpenUrl = "yuanwangwu://openpage?pageName=farmGamePage&accountId=1475332557208702976";
      // [js å¯¹urlè¿›è¡Œç¼–ç å’Œè§£ç ](https://blog.csdn.net/qq_42740797/article/details/111172160)
      // appOpenUrl = encodeURIComponent(appOpenUrl); // æç¤ºğŸ¤ï¼šå®é™…å‘ç°ï¼Œä¸ç¼–ç ï¼Œä¹Ÿå¯æ‰“å¼€
      url = "http://test-h5.yuanwangwu.com/pages-h5/share/share-farm?&accountId=1475332557208702976&appurl=" + appOpenUrl;
    } else {
      url = "https://www.baidu.com";
    }

    var map = {
      // "shareType": "Wechat_SESSION", // åˆ†äº«æ–¹å¼
      "shareWebPageUrl": url,
      "shareTitle": "ä½ çš„å¥½å‹å‘æ¥ä¸€æ¡åŠ æ€¥æ¶ˆæ¯", // åˆ†äº«æ ‡é¢˜
      "shareDescription": "æ€¥æ€¥æ€¥ï¼Œå¿«æ¥å¸®æˆ‘è½¬å¤§è½¬ç›˜ï¼Œ100%ä¸­å¥–ï¼", // åˆ†äº«æè¿°
      "shareThumbnailUrl": "https://img1.baidu.com/it/u=1605341541,1182642759&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1673370000&t=4e694f8a257f10a7f6b52bd051288e7d",
    };
    var message = JSON.stringify(map);
    _h5Action_updateText_forData('h5CallBridgeAction_share', message);
  }
  */

  /// æä¾›ç»™åŸç”Ÿè°ƒç”¨çš„h5æ–¹æ³•(ç”¨äºæµ‹è¯•åŸç”Ÿè°ƒç”¨çš„æ–¹æ³•åŠä¼ é€’å›æ¥çš„è¿”å›å€¼)
  function bridgeCallH5Action_showCallbackJsonString(jsonString) {
    if (jsonString == null || jsonString == undefined || !jsonString) {
      _showAlert("æ²¡æœ‰å›ä¼ çš„jsonStringå€¼");
      return;
    }
    _showAlert(`å›ä¼ çš„jsonStringå€¼ä¸º:${JSON.stringify(jsonString)}`);
  }

  /// è·³è½¬åˆ°ç¤ºä¾‹é¡µé¢
  function _h5Action_goDemoPage() {
    window.location.href = '?fileUrl=dvlp_h5js_demo.json';
  }


</script>

</html>